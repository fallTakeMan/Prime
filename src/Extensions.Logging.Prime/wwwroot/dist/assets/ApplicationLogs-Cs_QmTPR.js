import{_ as K,I as q,p as n,q as G,c as g,a as l,h as s,g as d,o as m,w as J,t as u,J as O,l as w,e as L,K as W}from"./index-CQGLhu-6.js";import{b as Y}from"./index-y4K16fDf.js";import{s as Q,a as X,L as V,b as Z,c as ee}from"./LogService-CFDrwnRU.js";import{s as le}from"./index-DP_7HvdA.js";import"./index-BQkXcjgv.js";import"./request-fA7VYk29.js";const te={class:"card"},se={class:"flex justify-between"},oe={class:"flex justify-between gap-4"},ae=["onClick"],ie={class:"limited-text"},ne={class:"flex items-center gap-4"},re={key:0},de={key:0,class:"rounded flex flex-col"},ue={class:"flex justify-center rounded"},pe={class:"relative mx-auto"},ve={class:"mb-2"},ce={class:"mb-2"},ge={class:"mb-2"},me={class:"mb-2"},fe={class:"mb-2"},be={key:0,class:"mb-2"},ye={__name:"ApplicationLogs",setup(xe){const k=q(),h=n(),v=n(),p=n(),f=n(),c=n(!1),b=n(!1),y=n(),C=n(""),r=n(),P=n(),T=n(1),x=n(20),N=n(0);function A(o){switch(o){case"Information":return"info";case"Warning":return"warn";case"Error":return"danger"}}function D(o){return o.toLocaleString("zh-CN")}const M=()=>{var o=p.value.map(e=>e.id);V.deleteApplicationLogs(o).then(()=>{v.value=v.value.filter(e=>!p.value.includes(e)),c.value=!1,p.value=null,k.add({severity:"success",summary:"Successful",detail:"Logs Deleted",life:3e3})}).catch(e=>{var i,a;k.add({severity:"error",summary:"Failed",detail:e.message+`\r
`+(((a=(i=e.response)==null?void 0:i.data)==null?void 0:a.message)??""),life:6e3})})},$=()=>{c.value=!0},z=()=>{h.value.exportCSV()},E=(o,e,i)=>{var a;y.value.hide(),((a=r.value)==null?void 0:a.id)===e.id&&P.value===i?r.value=null:(P.value=i,C.value=e[i],r.value=e,W(()=>{y.value.show(o)}))},B=o=>{T.value=o.page+1,x.value=o.rows,_()},_=()=>{f.value=!0,V.getApplicationLogs(T.value,x.value).then(o=>{v.value=o.data,N.value=o.paging.totalCount,f.value=!1,v.value.forEach(e=>e.logTime=new Date(e.logTime))}).catch(o=>{f.value=!1,console.log(o)})},U=o=>{r.value=o,b.value=!0};return G(()=>{_()}),(o,e)=>{const i=le,a=Z,j=ee,I=Q,S=X,F=Y,H=O;return m(),g("div",te,[e[16]||(e[16]=l("div",{class:"font-semibold text-xl mb-4"},"Application Logs",-1)),s(I,{ref_key:"dt",ref:h,selection:p.value,"onUpdate:selection":e[1]||(e[1]=t=>p.value=t),value:v.value,loading:f.value,paginator:!0,rowsPerPageOptions:[10,20,50,100,200,500],rows:x.value,totalRecords:N.value,rowHover:!0,lazy:!0,currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} logs",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",dataKey:"id",resizableColumns:"",columnResizeMode:"fit",showGridlines:"",scrollable:"",scrollHeight:"580px",tableStyle:"min-width: 50rem",onPage:e[2]||(e[2]=t=>B(t))},{header:d(()=>[l("div",se,[l("span",oe,[s(i,{label:"Refresh",icon:"pi pi-refresh",onClick:_,outlined:""}),s(i,{label:"Delete",icon:"pi pi-trash",severity:"danger",outlined:"",onClick:$,disabled:!p.value||!p.value.length},null,8,["disabled"]),s(i,{label:"Export",icon:"pi pi-upload",severity:"secondary",onClick:e[0]||(e[0]=t=>z(t))})]),e[6]||(e[6]=l("span",{class:"flex justify-between gap-4"},null,-1))])]),empty:d(()=>e[7]||(e[7]=[w(" No data found. ")])),loading:d(()=>e[8]||(e[8]=[w(" Loading application logs. Please wait. ")])),default:d(()=>[s(a,{selectionMode:"multiple",headerStyle:"width: 3rem"}),s(a,{exportable:!1},{body:d(({data:t})=>[s(i,{icon:"pi pi-search",onClick:R=>U(t),severity:"secondary",rounded:""},null,8,["onClick"])]),_:1}),s(a,{field:"eventName",header:"EventName",style:{"max-width":"15rem"}}),s(a,{field:"logLevel",header:"LogLevel",style:{"min-width":"10rem"}},{body:d(({data:t})=>[s(j,{value:t.logLevel,severity:A(t.logLevel)},null,8,["value","severity"])]),_:1}),s(a,{field:"logger",header:"Logger"}),s(a,{field:"message",header:"Message",style:{"max-width":"25rem"}},{body:d(({data:t})=>[J((m(),g("div",{class:"flex items-center gap-2",onClick:R=>E(R,t,"message")},[l("span",ie,u(t.message),1)],8,ae)),[[H,"click to view detail",void 0,{top:!0}]])]),_:1}),s(a,{field:"logTime",header:"LogTime",dataType:"date"},{body:d(({data:t})=>[w(u(D(t.logTime)),1)]),_:1}),s(a,{field:"userName",header:"UserName"})]),_:1},8,["selection","value","loading","rows","totalRecords"]),s(S,{visible:c.value,"onUpdate:visible":e[4]||(e[4]=t=>c.value=t),style:{width:"450px"},header:"Confirm",modal:!0},{footer:d(()=>[s(i,{label:"No",icon:"pi pi-times",text:"",onClick:e[3]||(e[3]=t=>c.value=!1)}),s(i,{label:"Yes",icon:"pi pi-check",text:"",onClick:M})]),default:d(()=>[l("div",ne,[e[9]||(e[9]=l("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),p.value?(m(),g("span",re,"Are you sure you want to delete the selected logs?")):L("",!0)])]),_:1},8,["visible"]),s(F,{ref_key:"msgPop",ref:y},{default:d(()=>[r.value?(m(),g("div",de,[l("div",ue,[l("div",pe,[l("span",null,u(C.value),1)])])])):L("",!0)]),_:1},512),s(S,{visible:b.value,"onUpdate:visible":e[5]||(e[5]=t=>b.value=t),modal:"",maximizable:"",header:"Log Detail",style:{width:"65rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:d(()=>[l("div",null,[l("div",ve,[e[10]||(e[10]=l("label",{class:"font-bold"},"[EventName]: ",-1)),l("span",null,u(r.value.eventName),1)]),l("div",ce,[e[11]||(e[11]=l("label",{class:"font-bold"},"[LogLevel]: ",-1)),l("span",null,u(r.value.logLevel),1)]),l("div",ge,[e[12]||(e[12]=l("label",{class:"font-bold"},"[Logger]: ",-1)),l("span",null,u(r.value.logger),1)]),l("div",me,[e[13]||(e[13]=l("label",{class:"font-bold"},"[Message]: ",-1)),l("span",null,u(r.value.message),1)]),l("div",fe,[e[14]||(e[14]=l("label",{class:"font-bold"},"[LogTime]: ",-1)),l("span",null,u(D(r.value.logTime)),1)]),r.value.userName?(m(),g("div",be,[e[15]||(e[15]=l("label",{class:"font-bold"},"[UserName]: ",-1)),l("span",null,u(r.value.userName),1)])):L("",!0)])]),_:1},8,["visible"])])}}},Pe=K(ye,[["__scopeId","data-v-660aafa4"]]);export{Pe as default};
